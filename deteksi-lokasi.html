<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Deteksi Lokasi Pengguna</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Inter',sans-serif;background:#F8F9FA;color:#333}
    .toggle-switch{position:relative;display:inline-block;width:44px;height:24px}
    .toggle-switch input{opacity:0;width:0;height:0}
    .toggle-slider{position:absolute;cursor:pointer;inset:0;background:#4a5568;transition:.3s;border-radius:24px}
    .toggle-slider:before{content:'';position:absolute;height:20px;width:20px;left:2px;bottom:2px;background:#fff;transition:.3s;border-radius:50%}
    input:checked + .toggle-slider{background:#20235c}
    input:checked + .toggle-slider:before{transform:translateX(20px)}
    body.lite .shadow, body.lite .shadow-md, body.lite .shadow-lg { box-shadow:none !important; }
    body.lite .card { box-shadow:none !important; }
    #overlay { display:none; }
    .show-overlay #overlay { display:block; }
  </style>
</head>
<body class="min-h-screen">

  <!-- Sidebar (fixed) -->
  <aside id="sidebar"
         class="fixed left-0 top-0 z-40 h-screen w-64 bg-[#1470F9] text-white flex flex-col p-4 shadow-lg
                transition-transform duration-200 -translate-x-full md:translate-x-0">
    <div class="flex-grow">
      <h1 class="text-2xl font-bold mb-8">
        <a href="#" class="text-white hover:text-indigo-200 transition">Lorem Ipsum</a>
      </h1>

      <nav>
        <ul class="space-y-2">
          <li>
            <a href="index.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M16 8v8m-4-4v4m-4-4v4m-2-12h10a2 2 0 012 2v10a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"></path>
              </svg>
              Dashboard
            </a>
          </li>

          <li>
            <a href="sebelum-profilgayabelajar.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
              </svg>
              Profil Gaya Belajar
            </a>
          </li>

          <li>
            <a href="rekomendasipembelajaran.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 6.253v13m0-13C10.832 5.435 9.177 5 7.5 5S4.168 5.435 3 6.253v13C4.168 18.435 5.823 18 7.5 18s3.332.435 4.5 1.253m0-13C13.168 5.435 14.823 5 16.5 5S19.832 5.435 21 6.253v13C19.832 18.435 18.177 18 16.5 18s-3.332.435-4.5 1.253"></path>
              </svg>
              Rekomendasi Pembelajaran
            </a>
          </li>

          <li>
            <a href="materi-pembelajaran.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none"
                   stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15.5 2H8.6c-.6 0-1.1.2-1.4.6-.3.4-.6.9-.6 1.4V20c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V7.5L15.5 2Z"/>
                <path d="M8 4v11c0 .6.4 1 1 1h10"/>
              </svg>
              <span class="ml-1">Materi Pembelajaran</span>
            </a>
          </li>

          <li>
            <a href="riwayat-pembelajaran.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21H6.737a2 2 0 01-1.789-2.894l3.5-7A2 2 0 019.263 9h5.474a2 2 0 012 2v.894"></path>
              </svg>
              Riwayat Pembelajaran
            </a>
          </li>
          <li>
            <a href="deteksi-lokasi.html"
               class="flex items-center p-3 rounded-lg hover:bg-white hover:text-blue-600 transition">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-map-pin-icon lucide-map-pin"><path d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"/><circle cx="12" cy="10" r="3"/>
              </svg>
              Deteksi Lokasi
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <div class="mt-auto pt-4 border-t border-indigo-700/60">
      <div class="flex items-center justify-between mb-4">
        <span class="text-sm font-medium">Lite Mode</span>
        <label class="toggle-switch">
          <input type="checkbox" id="lite-mode-toggle">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <a href="profile.html"
         class="p-3 rounded-lg flex items-center text-white hover:bg-white hover:text-blue-600 transition">
        <img src="https://placehold.co/40x40/94a3b8/ffffff?text=U" alt="User Avatar" class="w-10 h-10 rounded-full mr-3">
        <div class="flex-grow">
          <p class="font-medium">Culaccino_</p>
          <p class="text-sm">UX Designer</p>
        </div>
        <svg class="h-6 w-6 ml-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7"/>
        </svg>
      </a>

      <button id="logoutButton"
              class="w-full p-3 mt-2 text-left rounded-lg bg-red-500 text-white flex items-center justify-center transition">
        <svg class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
        </svg>
        Keluar
      </button>
    </div>
  </aside>

  <div id="overlay" class="fixed inset-0 bg-black/40 z-30 md:hidden"></div>

  <!-- Main content -->
  <main class="min-h-screen md:ml-64">
    <!-- Header -->
    <div class="sticky top-0 z-20 bg-white border-b border-gray-200">
      <div class="flex items-center justify-between p-4">
        <div class="flex items-center gap-2">
          <button id="openSidebar"
                  class="md:hidden inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-200 hover:bg-gray-300">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
          <div>
            <h1 class="text-xl font-bold text-gray-800">Deteksi Lokasi Pengguna</h1>
            <p class="text-sm text-gray-600">Klik tombol untuk mendapatkan koordinat lokasi.</p>
          </div>
        </div>
        <span id="liteBadge"
              class="px-3 py-1 rounded-full text-xs font-semibold bg-gray-200 text-gray-700">Normal</span>
      </div>
    </div>

    <!-- Content -->
    <div class="p-4 flex items-center justify-center min-h-[calc(100vh-64px)]">
      <div class="card bg-white border rounded-xl p-5 shadow max-w-lg w-full">
        <h2 class="text-lg font-semibold mb-2 text-center">Geolokasi</h2>
        <p class="text-gray-600 text-sm mb-4 text-center">Deteksi lokasi perangkat kamu.</p>

        <div class="flex justify-center">
          <button id="detectBtn"
                  class="px-4 py-2 rounded-lg bg-[#1470F9] text-white font-medium hover:bg-[#0f54b6]">
            Deteksi Lokasi
          </button>
        </div>

        <!-- Hasil -->
        <div id="result" class="mt-4 space-y-3">
          <div class="p-4 bg-gray-50 border rounded-lg text-gray-800">
            Belum ada hasil. Tekan tombol di atas.
          </div>
        </div>

        <!-- Catatan -->
      </div>
    </div>
  </main>

  <script>
    // ====== EDIT DUMMY DATA DI SINI ======
    const dummyLocation = {
      region: "Jawa Tengah",
      city: "Yogyakarta",
      district: "Sleman",
      coords: { lat: -6.914744, lng: 107.609810 } // koord dummy
    };
    // Pakai dummy saja (abaikan geolocation)? set true jika mau
    const useDummyOnly = false;
    // =====================================

    // ====== Sidebar toggle (mobile) ======
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const openBtn = document.getElementById('openSidebar');

    function openSidebarMobile() {
      sidebar.classList.remove('-translate-x-full');
      document.body.classList.add('show-overlay');
    }
    function closeSidebarMobile() {
      sidebar.classList.add('-translate-x-full');
      document.body.classList.remove('show-overlay');
    }
    openBtn?.addEventListener('click', openSidebarMobile);
    overlay?.addEventListener('click', closeSidebarMobile);

    const mql = window.matchMedia('(min-width: 768px)');
    mql.addEventListener('change', e => { if (e.matches) closeSidebarMobile(); });

    // ====== Lite Mode (visual only) ======
    const liteToggle = document.getElementById('lite-mode-toggle');
    const liteBadge = document.getElementById('liteBadge');
    function applyLite(on) {
      document.body.classList.toggle('lite', on);
      if (liteBadge) {
        liteBadge.textContent = on ? 'Lite ON' : 'Normal';
        liteBadge.className = 'px-3 py-1 rounded-full text-xs font-semibold ' + (on ? 'bg-emerald-100 text-emerald-700' : 'bg-gray-200 text-gray-700');
      }
      try { localStorage.setItem('lite_mode', on ? '1' : '0'); } catch {}
    }
    try {
      const saved = localStorage.getItem('lite_mode');
      if (saved === '1') {
        liteToggle.checked = true;
        applyLite(true);
      }
    } catch {}
    liteToggle?.addEventListener('change', e => applyLite(e.target.checked));

    // ====== Deteksi Lokasi ======
    const btn = document.getElementById('detectBtn');
    const out = document.getElementById('result');

    function renderDummyOnly(note = "") {
      out.innerHTML = `
        ${note ? `<div class="p-3 rounded bg-amber-50 border border-amber-200 text-amber-800 text-sm">${note}</div>` : ""}
        <div class="grid md:grid-cols-2 gap-3">
          <div class="p-4 bg-gray-50 border rounded-lg">
            <p class="font-semibold mb-1">Koordinat (Dummy)</p>
            <p>Lat: ${dummyLocation.coords.lat}, Lng: ${dummyLocation.coords.lng}</p>
          </div>
          <div class="p-4 bg-gray-50 border rounded-lg">
            <p class="font-semibold mb-1">Data Lokasi (Dummy)</p>
            <ul class="text-sm leading-6">
              <li><b>Provinsi:</b> ${dummyLocation.region}</li>
              <li><b>Kota/Kab:</b> ${dummyLocation.city}</li>
              <li><b>Kecamatan:</b> ${dummyLocation.district}</li>
            </ul>
          </div>
        </div>`;
    }

    btn.addEventListener('click', () => {
      if (useDummyOnly) {
        renderDummyOnly("Mode dummy saja: geolokasi perangkat diabaikan.");
        return;
      }

      if (!navigator.geolocation) {
        renderDummyOnly("Browser tidak mendukung geolokasi. Menampilkan data dummy.");
        return;
      }

      out.innerHTML = `<div class="p-4 bg-gray-50 border rounded-lg">Meminta izin dan mendeteksi lokasi...</div>`;

      navigator.geolocation.getCurrentPosition(
        pos => {
          const lat = pos.coords.latitude.toFixed(5);
          const lng = pos.coords.longitude.toFixed(5);

          out.innerHTML = `
            <div class="grid md:grid-cols-2 gap-3">
              <div class="p-4 bg-gray-50 border rounded-lg">
                <p class="font-semibold mb-1">Koordinat</p>
                <p>Lat: ${lat}, Lng: ${lng}</p>
              </div>
              <div class="p-4 bg-gray-50 border rounded-lg">
                <p class="font-semibold mb-1">Data Lokasi</p>
                <ul class="text-sm leading-6">
                  <li><b>Provinsi:</b> ${dummyLocation.region}</li>
                  <li><b>Kota/Kab:</b> ${dummyLocation.city}</li>
                  <li><b>Kecamatan:</b> ${dummyLocation.district}</li>
                </ul>
              </div>
            </div>
          `;
        },
        err => {
          renderDummyOnly(`Gagal mendapatkan lokasi perangkat: ${err.message}. Menampilkan data dummy.`);
        },
        { enableHighAccuracy:false, timeout:8000, maximumAge:0 }
      );
    });

    document.getElementById('logoutButton')?.addEventListener('click', () => {
      alert('Logout berhasil (demo).');
      // window.location.href = 'login.html';
    });
  </script>
</body>
</html>
